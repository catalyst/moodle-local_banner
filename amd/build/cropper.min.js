!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Cropper=b()}(this,function(){"use strict";function a(a){return ga.call(a).slice(8,-1).toLowerCase()}function b(a){return"number"==typeof a&&!isNaN(a)}function c(a){return"undefined"==typeof a}function d(a){return"object"===("undefined"==typeof a?"undefined":U(a))&&null!==a}function e(a){if(!d(a))return!1;try{var b=a.constructor,c=b.prototype;return b&&c&&ha.call(c,"isPrototypeOf")}catch(e){return!1}}function f(b){return"function"===a(b)}function g(b){return Array.isArray?Array.isArray(b):"array"===a(b)}function h(a){return"string"==typeof a&&(a=a.trim?a.trim():a.replace(ba,"$1")),a}function i(a,c){if(a&&f(c)){var e=void 0;if(g(a)||b(a.length)){var h=a.length;for(e=0;h>e&&c.call(a,a[e],e,a)!==!1;e++);}else d(a)&&Object.keys(a).forEach(function(b){c.call(a,a[b],b,a)})}return a}function j(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var e=b[0]===!0,f=e?b[1]:b[0];return b.length>1&&(b.shift(),b.forEach(function(a){d(a)&&Object.keys(a).forEach(function(b){e&&d(f[b])?j(!0,f[b],a[b]):f[b]=a[b]})})),f}function k(a,b){for(var c=arguments.length,d=Array(c>2?c-2:0),e=2;c>e;e++)d[e-2]=arguments[e];return function(){for(var c=arguments.length,e=Array(c),f=0;c>f;f++)e[f]=arguments[f];return a.apply(b,d.concat(e))}}function l(a,c){var d=a.style;i(c,function(a,c){aa.test(c)&&b(a)&&(a+="px"),d[c]=a})}function m(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function n(a,c){if(b(a.length))return void i(a,function(a){n(a,c)});if(a.classList)return void a.classList.add(c);var d=h(a.className);d?d.indexOf(c)<0&&(a.className=d+" "+c):a.className=c}function o(a,c){return b(a.length)?void i(a,function(a){o(a,c)}):a.classList?void a.classList.remove(c):void(a.className.indexOf(c)>=0&&(a.className=a.className.replace(c,"")))}function p(a,c,d){return b(a.length)?void i(a,function(a){p(a,c,d)}):void(d?n(a,c):o(a,c))}function q(a){return a.replace(Z,"$1-$2").toLowerCase()}function r(a,b){return d(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-"+q(b))}function s(a,b,c){d(c)?a[b]=c:a.dataset?a.dataset[b]=c:a.setAttribute("data-"+q(b),c)}function t(a,b){if(d(a[b]))delete a[b];else if(a.dataset)try{delete a.dataset[b]}catch(c){a.dataset[b]=null}else a.removeAttribute("data-"+q(b))}function u(a,b,c){var d=h(b).split(_);return d.length>1?void i(d,function(b){u(a,b,c)}):void(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c))}function v(a,b,c,d){var e=h(b).split(_),f=c;return e.length>1?void i(e,function(b){v(a,b,c)}):(d&&(c=function(){for(var d=arguments.length,e=Array(d),g=0;d>g;g++)e[g]=arguments[g];return u(a,b,c),f.apply(a,e)}),void(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)))}function w(a,b,d){if(a.dispatchEvent){var e=void 0;return f(Event)&&f(CustomEvent)?e=c(d)?new Event(b,{bubbles:!0,cancelable:!0}):new CustomEvent(b,{detail:d,bubbles:!0,cancelable:!0}):c(d)?(e=document.createEvent("Event"),e.initEvent(b,!0,!0)):(e=document.createEvent("CustomEvent"),e.initCustomEvent(b,!0,!0,d)),a.dispatchEvent(e)}return a.fireEvent?a.fireEvent("on"+b):!0}function x(a){var c=a||window.event;if(c.target||(c.target=c.srcElement||document),!b(c.pageX)&&b(c.clientX)){var d=a.target.ownerDocument||document,e=d.documentElement,f=d.body;c.pageX=c.clientX+((e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0)),c.pageY=c.clientY+((e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0))}return c}function y(a){var b=document.documentElement,c=a.getBoundingClientRect();return{left:c.left+((window.scrollX||b&&b.scrollLeft||0)-(b&&b.clientLeft||0)),top:c.top+((window.scrollY||b&&b.scrollTop||0)-(b&&b.clientTop||0))}}function z(a,b){return a.getElementsByTagName(b)}function A(a,b){return a.getElementsByClassName?a.getElementsByClassName(b):a.querySelectorAll("."+b)}function B(a){return document.createElement(a)}function C(a,b){a.appendChild(b)}function D(a){a.parentNode&&a.parentNode.removeChild(a)}function E(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function F(a){var b=a.match($);return b&&(b[1]!==location.protocol||b[2]!==location.hostname||b[3]!==location.port)}function G(a){var b="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+b}function H(a,b){if(a.naturalWidth&&!ea)return void b(a.naturalWidth,a.naturalHeight);var c=B("img");c.onload=function(){b(this.width,this.height)},c.src=a.src}function I(a){var c=[],d=a.rotate,e=a.scaleX,f=a.scaleY;return b(d)&&0!==d&&c.push("rotate("+d+"deg)"),b(e)&&1!==e&&c.push("scaleX("+e+")"),b(f)&&1!==f&&c.push("scaleY("+f+")"),c.length?c.join(" "):"none"}function J(a,b){var c=Math.abs(a.degree)%180,d=(c>90?180-c:c)*Math.PI/180,e=Math.sin(d),f=Math.cos(d),g=a.width,h=a.height,i=a.aspectRatio,j=void 0,k=void 0;return b?(j=g/(f+e/i),k=j/i):(j=g*f+h*e,k=g*e+h*f),{width:j,height:k}}function K(a,c){var d=B("canvas"),e=d.getContext("2d"),f=0,g=0,h=c.naturalWidth,i=c.naturalHeight,j=c.rotate,k=c.scaleX,l=c.scaleY,m=b(k)&&b(l)&&(1!==k||1!==l),n=b(j)&&0!==j,o=n||m,p=h*Math.abs(k||1),q=i*Math.abs(l||1),r=void 0,s=void 0,t=void 0;return m&&(r=p/2,s=q/2),n&&(t=J({width:p,height:q,degree:j}),p=t.width,q=t.height,r=p/2,s=q/2),d.width=p,d.height=q,o&&(f=-h/2,g=-i/2,e.save(),e.translate(r,s)),n&&e.rotate(j*Math.PI/180),m&&e.scale(k,l),e.drawImage(a,Math.floor(f),Math.floor(g),Math.floor(h),Math.floor(i)),o&&e.restore(),d}function L(a,b,c){var d="",e=b;for(c+=b;c>e;e++)d+=ia(a.getUint8(e));return d}function M(a){var b=new DataView(a),c=b.byteLength,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0;if(255===b.getUint8(0)&&216===b.getUint8(1))for(l=2;c>l;){if(255===b.getUint8(l)&&225===b.getUint8(l+1)){j=l;break}l++}if(j&&(e=j+4,f=j+10,"Exif"===L(b,e,4)&&(i=b.getUint16(f),h=18761===i,(h||19789===i)&&42===b.getUint16(f+2,h)&&(g=b.getUint32(f+4,h),g>=8&&(k=f+g)))),k)for(c=b.getUint16(k,h),m=0;c>m;m++)if(l=k+12*m+2,274===b.getUint16(l,h)){l+=8,d=b.getUint16(l,h),ea&&b.setUint16(l,1,h);break}return d}function N(a){var b=a.replace(Y,""),c=atob(b),d=c.length,e=new ArrayBuffer(d),f=new Uint8Array(e),g=void 0;for(g=0;d>g;g++)f[g]=c.charCodeAt(g);return e}function O(a){var b=new Uint8Array(a),c=b.length,d="",e=void 0;for(e=0;c>e;e++)d+=ia(b[e]);return"data:image/jpeg;base64,"+btoa(d)}function P(a,b){var c=a.pageX,d=a.pageY,e={endX:c,endY:d};return b?e:j({startX:c,startY:d},e)}function Q(a){var b=j({},a),c=[];return i(a,function(a,d){delete b[d],i(b,function(b){var d=Math.abs(a.startX-b.startX),e=Math.abs(a.startY-b.startY),f=Math.abs(a.endX-b.endX),g=Math.abs(a.endY-b.endY),h=Math.sqrt(d*d+e*e),i=Math.sqrt(f*f+g*g),j=(i-h)/h;c.push(j)})}),c.sort(function(a,b){return Math.abs(a)<Math.abs(b)}),c[0]}function R(a){var b=0,c=0,d=0;return i(a,function(a){var e=a.startX,f=a.startY;b+=e,c+=f,d+=1}),b/=d,c/=d,{pageX:b,pageY:c}}var S={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},T='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},V=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},W=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),X=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},Y=/^data:([^;]+);base64,/,Z=/([a-z\d])([A-Z])/g,$=/^(https?:)\/\/([^:\/?#]+):?(\d*)/i,_=/\s+/,aa=/^(width|height|left|top|marginLeft|marginTop)$/,ba=/^\s+(.*)\s+$/,ca=/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i,da="undefined"!=typeof window?window.navigator:null,ea=da&&ca.test(da.userAgent),fa=Object.prototype,ga=fa.toString,ha=fa.hasOwnProperty,ia=(Array.prototype.slice,String.fromCharCode),ja={render:function(){var a=this;a.initContainer(),a.initCanvas(),a.initCropBox(),a.renderCanvas(),a.cropped&&a.renderCropBox()},initContainer:function(){var a=this,b=a.options,c=a.element,d=a.container,e=a.cropper,f=void 0;n(e,"cropper-hidden"),o(c,"cropper-hidden"),a.containerData=f={width:Math.max(d.offsetWidth,Number(b.minContainerWidth)||200),height:Math.max(d.offsetHeight,Number(b.minContainerHeight)||100)},l(e,{width:f.width,height:f.height}),n(c,"cropper-hidden"),o(e,"cropper-hidden")},initCanvas:function(){var a=this,b=a.options.viewMode,c=a.containerData,d=a.imageData,e=90===Math.abs(d.rotate),f=e?d.naturalHeight:d.naturalWidth,g=e?d.naturalWidth:d.naturalHeight,h=f/g,i=c.width,k=c.height;c.height*h>c.width?3===b?i=c.height*h:k=c.width/h:3===b?k=c.width/h:i=c.height*h;var l={naturalWidth:f,naturalHeight:g,aspectRatio:h,width:i,height:k};l.oldLeft=l.left=(c.width-i)/2,l.oldTop=l.top=(c.height-k)/2,a.canvasData=l,a.limited=1===b||2===b,a.limitCanvas(!0,!0),a.initialImageData=j({},d),a.initialCanvasData=j({},l)},limitCanvas:function(a,b){var c=this,d=c.options,e=d.viewMode,f=c.containerData,g=c.canvasData,h=g.aspectRatio,i=c.cropBoxData,j=c.cropped&&i,k=void 0,l=void 0,m=void 0,n=void 0;a&&(k=Number(d.minCanvasWidth)||0,l=Number(d.minCanvasHeight)||0,e>1?(k=Math.max(k,f.width),l=Math.max(l,f.height),3===e&&(l*h>k?k=l*h:l=k/h)):e>0&&(k?k=Math.max(k,j?i.width:0):l?l=Math.max(l,j?i.height:0):j&&(k=i.width,l=i.height,l*h>k?k=l*h:l=k/h)),k&&l?l*h>k?l=k/h:k=l*h:k?l=k/h:l&&(k=l*h),g.minWidth=k,g.minHeight=l,g.maxWidth=1/0,g.maxHeight=1/0),b&&(e?(m=f.width-g.width,n=f.height-g.height,g.minLeft=Math.min(0,m),g.minTop=Math.min(0,n),g.maxLeft=Math.max(0,m),g.maxTop=Math.max(0,n),j&&c.limited&&(g.minLeft=Math.min(i.left,i.left+(i.width-g.width)),g.minTop=Math.min(i.top,i.top+(i.height-g.height)),g.maxLeft=i.left,g.maxTop=i.top,2===e&&(g.width>=f.width&&(g.minLeft=Math.min(0,m),g.maxLeft=Math.max(0,m)),g.height>=f.height&&(g.minTop=Math.min(0,n),g.maxTop=Math.max(0,n))))):(g.minLeft=-g.width,g.minTop=-g.height,g.maxLeft=f.width,g.maxTop=f.height))},renderCanvas:function(a){var b=this,c=b.canvasData,d=b.imageData,e=d.rotate,f=void 0,g=void 0;b.rotated&&(b.rotated=!1,g=J({width:d.width,height:d.height,degree:e}),f=g.width/g.height,f!==c.aspectRatio&&(c.left-=(g.width-c.width)/2,c.top-=(g.height-c.height)/2,c.width=g.width,c.height=g.height,c.aspectRatio=f,c.naturalWidth=d.naturalWidth,c.naturalHeight=d.naturalHeight,e%180&&(g=J({width:d.naturalWidth,height:d.naturalHeight,degree:e}),c.naturalWidth=g.width,c.naturalHeight=g.height),b.limitCanvas(!0,!1))),(c.width>c.maxWidth||c.width<c.minWidth)&&(c.left=c.oldLeft),(c.height>c.maxHeight||c.height<c.minHeight)&&(c.top=c.oldTop),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),b.limitCanvas(!1,!0),c.oldLeft=c.left=Math.min(Math.max(c.left,c.minLeft),c.maxLeft),c.oldTop=c.top=Math.min(Math.max(c.top,c.minTop),c.maxTop),l(b.canvas,{width:c.width,height:c.height,left:c.left,top:c.top}),b.renderImage(),b.cropped&&b.limited&&b.limitCropBox(!0,!0),a&&b.output()},renderImage:function(a){var b=this,c=b.canvasData,d=b.imageData,e=void 0,f=void 0,g=void 0,h=void 0;d.rotate&&(f=J({width:c.width,height:c.height,degree:d.rotate,aspectRatio:d.aspectRatio},!0),g=f.width,h=f.height,e={width:g,height:h,left:(c.width-g)/2,top:(c.height-h)/2}),j(d,e||{width:c.width,height:c.height,left:0,top:0});var i=I(d);l(b.image,{width:d.width,height:d.height,marginLeft:d.left,marginTop:d.top,WebkitTransform:i,msTransform:i,transform:i}),a&&b.output()},initCropBox:function(){var a=this,b=a.options,c=b.aspectRatio,d=Number(b.autoCropArea)||.8,e=a.canvasData,f={width:e.width,height:e.height};c&&(e.height*c>e.width?f.height=f.width/c:f.width=f.height*c),a.cropBoxData=f,a.limitCropBox(!0,!0),f.width=Math.min(Math.max(f.width,f.minWidth),f.maxWidth),f.height=Math.min(Math.max(f.height,f.minHeight),f.maxHeight),f.width=Math.max(f.minWidth,f.width*d),f.height=Math.max(f.minHeight,f.height*d),f.oldLeft=f.left=e.left+(e.width-f.width)/2,f.oldTop=f.top=e.top+(e.height-f.height)/2,a.initialCropBoxData=j({},f)},limitCropBox:function(a,b){var c=this,d=c.options,e=d.aspectRatio,f=c.containerData,g=c.canvasData,h=c.cropBoxData,i=c.limited,j=void 0,k=void 0,l=void 0,m=void 0;a&&(j=Number(d.minCropBoxWidth)||0,k=Number(d.minCropBoxHeight)||0,j=Math.min(j,f.width),k=Math.min(k,f.height),l=Math.min(f.width,i?g.width:f.width),m=Math.min(f.height,i?g.height:f.height),e&&(j&&k?k*e>j?k=j/e:j=k*e:j?k=j/e:k&&(j=k*e),m*e>l?m=l/e:l=m*e),h.minWidth=Math.min(j,l),h.minHeight=Math.min(k,m),h.maxWidth=l,h.maxHeight=m),b&&(i?(h.minLeft=Math.max(0,g.left),h.minTop=Math.max(0,g.top),h.maxLeft=Math.min(f.width,g.left+g.width)-h.width,h.maxTop=Math.min(f.height,g.top+g.height)-h.height):(h.minLeft=0,h.minTop=0,h.maxLeft=f.width-h.width,h.maxTop=f.height-h.height))},renderCropBox:function(){var a=this,b=a.options,c=a.containerData,d=a.cropBoxData;(d.width>d.maxWidth||d.width<d.minWidth)&&(d.left=d.oldLeft),(d.height>d.maxHeight||d.height<d.minHeight)&&(d.top=d.oldTop),d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth),d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight),a.limitCropBox(!1,!0),d.oldLeft=d.left=Math.min(Math.max(d.left,d.minLeft),d.maxLeft),d.oldTop=d.top=Math.min(Math.max(d.top,d.minTop),d.maxTop),b.movable&&b.cropBoxMovable&&s(a.face,"action",d.width===c.width&&d.height===c.height?"move":"all"),l(a.cropBox,{width:d.width,height:d.height,left:d.left,top:d.top}),a.cropped&&a.limited&&a.limitCanvas(!0,!0),a.disabled||a.output()},output:function(){var a=this;a.preview(),a.complete&&w(a.element,"crop",a.getData())}},ka="preview",la={initPreview:function(){var a=this,b=a.options.preview,c=B("img"),d=a.crossOrigin,e=d?a.crossOriginUrl:a.url;if(d&&(c.crossOrigin=d),c.src=e,C(a.viewBox,c),a.image2=c,b){var f=b.querySelector?[b]:document.querySelectorAll(b);a.previews=f,i(f,function(a){var b=B("img");s(a,ka,{width:a.offsetWidth,height:a.offsetHeight,html:a.innerHTML}),d&&(b.crossOrigin=d),b.src=e,b.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',E(a),C(a,b)})}},resetPreview:function(){i(this.previews,function(a){var b=r(a,ka);l(a,{width:b.width,height:b.height}),a.innerHTML=b.html,t(a,ka)})},preview:function(){var a=this,b=a.imageData,c=a.canvasData,d=a.cropBoxData,e=d.width,f=d.height,g=b.width,h=b.height,k=d.left-c.left-b.left,m=d.top-c.top-b.top,n=I(b),o={WebkitTransform:n,msTransform:n,transform:n};a.cropped&&!a.disabled&&(l(a.image2,j({width:g,height:h,marginLeft:-k,marginTop:-m},o)),i(a.previews,function(a){var b=r(a,ka),c=b.width,d=b.height,i=c,n=d,p=1;e&&(p=c/e,n=f*p),f&&n>d&&(p=d/f,i=e*p,n=d),l(a,{width:i,height:n}),l(z(a,"img")[0],j({width:g*p,height:h*p,marginLeft:-k*p,marginTop:-m*p},o))}))}},ma="undefined"!=typeof window?window.PointerEvent:null,na=ma?"pointerdown":"touchstart mousedown",oa=ma?"pointermove":"touchmove mousemove",pa=ma?" pointerup pointercancel":"touchend touchcancel mouseup",qa="wheel mousewheel DOMMouseScroll",ra="dblclick",sa="resize",ta="cropstart",ua="cropmove",va="cropend",wa="crop",xa="zoom",ya={bind:function(){var a=this,b=a.options,c=a.element,d=a.cropper;f(b.cropstart)&&v(c,ta,b.cropstart),f(b.cropmove)&&v(c,ua,b.cropmove),f(b.cropend)&&v(c,va,b.cropend),f(b.crop)&&v(c,wa,b.crop),f(b.zoom)&&v(c,xa,b.zoom),v(d,na,a.onCropStart=k(a.cropStart,a)),b.zoomable&&b.zoomOnWheel&&v(d,qa,a.onWheel=k(a.wheel,a)),b.toggleDragModeOnDblclick&&v(d,ra,a.onDblclick=k(a.dblclick,a)),v(document,oa,a.onCropMove=k(a.cropMove,a)),v(document,pa,a.onCropEnd=k(a.cropEnd,a)),b.responsive&&v(window,sa,a.onResize=k(a.resize,a))},unbind:function(){var a=this,b=a.options,c=a.element,d=a.cropper;f(b.cropstart)&&u(c,ta,b.cropstart),f(b.cropmove)&&u(c,ua,b.cropmove),f(b.cropend)&&u(c,va,b.cropend),f(b.crop)&&u(c,wa,b.crop),f(b.zoom)&&u(c,xa,b.zoom),u(d,na,a.onCropStart),b.zoomable&&b.zoomOnWheel&&u(d,qa,a.onWheel),b.toggleDragModeOnDblclick&&u(d,ra,a.onDblclick),u(document,oa,a.onCropMove),u(document,pa,a.onCropEnd),b.responsive&&u(window,sa,a.onResize)}},za=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,Aa={resize:function(){var a=this,b=a.options.restore,c=a.container,d=a.containerData;if(!a.disabled&&d){var e=c.offsetWidth/d.width,f=void 0,g=void 0;(1!==e||c.offsetHeight!==d.height)&&(b&&(f=a.getCanvasData(),g=a.getCropBoxData()),a.render(),b&&(a.setCanvasData(i(f,function(a,b){f[b]=a*e})),a.setCropBoxData(i(g,function(a,b){g[b]=a*e}))))}},dblclick:function(){var a=this;a.disabled||a.setDragMode(m(a.dragBox,"cropper-crop")?"move":"crop")},wheel:function(a){var b=this,c=x(a),d=Number(b.options.wheelZoomRatio)||.1,e=1;b.disabled||(c.preventDefault(),b.wheeling||(b.wheeling=!0,setTimeout(function(){b.wheeling=!1},50),c.deltaY?e=c.deltaY>0?1:-1:c.wheelDelta?e=-c.wheelDelta/120:c.detail&&(e=c.detail>0?1:-1),b.zoom(-e*d,c)))},cropStart:function(a){var b=this;if(!b.disabled){var c=b.options,d=b.pointers,e=x(a),f=void 0;if(e.changedTouches?i(e.changedTouches,function(a){d[a.identifier]=P(a)}):d[e.pointerId||0]=P(e),f=Object.keys(d).length>1&&c.zoomable&&c.zoomOnTouch?"zoom":r(e.target,"action"),za.test(f)){if(w(b.element,"cropstart",{originalEvent:e,action:f})===!1)return;e.preventDefault(),b.action=f,b.cropping=!1,"crop"===f&&(b.cropping=!0,n(b.dragBox,"cropper-modal"))}}},cropMove:function(a){var b=this,c=b.action;if(!b.disabled&&c){var d=b.pointers,e=x(a);e.preventDefault(),w(b.element,"cropmove",{originalEvent:e,action:c})!==!1&&(e.changedTouches?i(e.changedTouches,function(a){j(d[a.identifier],P(a,!0))}):j(d[e.pointerId||0],P(e,!0)),b.change(e))}},cropEnd:function(a){var b=this,c=b.action;if(!b.disabled&&c){var d=b.pointers,e=x(a);e.preventDefault(),e.changedTouches?i(e.changedTouches,function(a){delete d[a.identifier]}):delete d[e.pointerId||0],Object.keys(d).length||(b.action=""),b.cropping&&(b.cropping=!1,p(b.dragBox,"cropper-modal",b.cropped&&this.options.modal)),w(b.element,"cropend",{originalEvent:e,action:c})}}},Ba="e",Ca="w",Da="s",Ea="n",Fa="se",Ga="sw",Ha="ne",Ia="nw",Ja={change:function(a){var b=this,c=b.options,d=b.containerData,e=b.canvasData,f=b.cropBoxData,g=c.aspectRatio,h=b.action,j=f.width,k=f.height,l=f.left,m=f.top,n=l+j,p=m+k,q=0,r=0,s=d.width,t=d.height,u=!0,v=void 0;!g&&a.shiftKey&&(g=j&&k?j/k:1),b.limited&&(q=f.minLeft,r=f.minTop,s=q+Math.min(d.width,e.width,e.left+e.width),t=r+Math.min(d.height,e.height,e.top+e.height));var w=b.pointers,x=w[Object.keys(w)[0]],z={x:x.endX-x.startX,y:x.endY-x.startY};switch(g&&(z.X=z.y*g,z.Y=z.x/g),h){case"all":l+=z.x,m+=z.y;break;case Ba:if(z.x>=0&&(n>=s||g&&(r>=m||p>=t))){u=!1;break}j+=z.x,g&&(k=j/g,m-=z.Y/2),0>j&&(h=Ca,j=0);break;case Ea:if(z.y<=0&&(r>=m||g&&(q>=l||n>=s))){u=!1;break}k-=z.y,m+=z.y,g&&(j=k*g,l+=z.X/2),0>k&&(h=Da,k=0);break;case Ca:if(z.x<=0&&(q>=l||g&&(r>=m||p>=t))){u=!1;break}j-=z.x,l+=z.x,g&&(k=j/g,m+=z.Y/2),0>j&&(h=Ba,j=0);break;case Da:if(z.y>=0&&(p>=t||g&&(q>=l||n>=s))){u=!1;break}k+=z.y,g&&(j=k*g,l-=z.X/2),0>k&&(h=Ea,k=0);break;case Ha:if(g){if(z.y<=0&&(r>=m||n>=s)){u=!1;break}k-=z.y,m+=z.y,j=k*g}else z.x>=0?s>n?j+=z.x:z.y<=0&&r>=m&&(u=!1):j+=z.x,z.y<=0?m>r&&(k-=z.y,m+=z.y):(k-=z.y,m+=z.y);0>j&&0>k?(h=Ga,k=0,j=0):0>j?(h=Ia,j=0):0>k&&(h=Fa,k=0);break;case Ia:if(g){if(z.y<=0&&(r>=m||q>=l)){u=!1;break}k-=z.y,m+=z.y,j=k*g,l+=z.X}else z.x<=0?l>q?(j-=z.x,l+=z.x):z.y<=0&&r>=m&&(u=!1):(j-=z.x,l+=z.x),z.y<=0?m>r&&(k-=z.y,m+=z.y):(k-=z.y,m+=z.y);0>j&&0>k?(h=Fa,k=0,j=0):0>j?(h=Ha,j=0):0>k&&(h=Ga,k=0);break;case Ga:if(g){if(z.x<=0&&(q>=l||p>=t)){u=!1;break}j-=z.x,l+=z.x,k=j/g}else z.x<=0?l>q?(j-=z.x,l+=z.x):z.y>=0&&p>=t&&(u=!1):(j-=z.x,l+=z.x),z.y>=0?t>p&&(k+=z.y):k+=z.y;0>j&&0>k?(h=Ha,k=0,j=0):0>j?(h=Fa,j=0):0>k&&(h=Ia,k=0);break;case Fa:if(g){if(z.x>=0&&(n>=s||p>=t)){u=!1;break}j+=z.x,k=j/g}else z.x>=0?s>n?j+=z.x:z.y>=0&&p>=t&&(u=!1):j+=z.x,z.y>=0?t>p&&(k+=z.y):k+=z.y;0>j&&0>k?(h=Ia,k=0,j=0):0>j?(h=Ga,j=0):0>k&&(h=Ha,k=0);break;case"move":b.move(z.x,z.y),u=!1;break;case"zoom":b.zoom(Q(w),a),u=!1;break;case"crop":if(!z.x||!z.y){u=!1;break}v=y(b.cropper),l=x.startX-v.left,m=x.startY-v.top,j=f.minWidth,k=f.minHeight,z.x>0?h=z.y>0?Fa:Ha:z.x<0&&(l-=j,h=z.y>0?Ga:Ia),z.y<0&&(m-=k),b.cropped||(o(b.cropBox,"cropper-hidden"),b.cropped=!0,b.limited&&b.limitCropBox(!0,!0))}u&&(f.width=j,f.height=k,f.left=l,f.top=m,b.action=h,b.renderCropBox()),i(w,function(a){a.startX=a.endX,a.startY=a.endY})}},Ka={crop:function(){var a=this;return a.ready&&!a.disabled&&(a.cropped||(a.cropped=!0,a.limitCropBox(!0,!0),a.options.modal&&n(a.dragBox,"cropper-modal"),o(a.cropBox,"cropper-hidden")),a.setCropBoxData(a.initialCropBoxData)),a},reset:function(){var a=this;return a.ready&&!a.disabled&&(a.imageData=j({},a.initialImageData),a.canvasData=j({},a.initialCanvasData),a.cropBoxData=j({},a.initialCropBoxData),a.renderCanvas(),a.cropped&&a.renderCropBox()),a},clear:function(){var a=this;return a.cropped&&!a.disabled&&(j(a.cropBoxData,{left:0,top:0,width:0,height:0}),a.cropped=!1,a.renderCropBox(),a.limitCanvas(),a.renderCanvas(),o(a.dragBox,"cropper-modal"),n(a.cropBox,"cropper-hidden")),a},replace:function(a,b){var c=this;return!c.disabled&&a&&(c.isImg&&(c.element.src=a),b?(c.url=a,c.image.src=a,c.ready&&(c.image2.src=a,i(c.previews,function(b){z(b,"img")[0].src=a}))):(c.isImg&&(c.replaced=!0),c.options.data=null,c.load(a))),c},enable:function(){var a=this;return a.ready&&(a.disabled=!1,o(a.cropper,"cropper-disabled")),a},disable:function(){var a=this;return a.ready&&(a.disabled=!0,n(a.cropper,"cropper-disabled")),a},destroy:function(){var a=this,b=a.element,c=a.image;return a.loaded?(a.isImg&&a.replaced&&(b.src=a.originalUrl),a.unbuild(),o(b,"cropper-hidden")):a.isImg?u(b,"load",a.start):c&&D(c),t(b,"cropper"),a},move:function(a,b){var d=this,e=d.canvasData;return d.moveTo(c(a)?a:e.left+Number(a),c(b)?b:e.top+Number(b))},moveTo:function(a,d){var e=this,f=e.canvasData,g=!1;return c(d)&&(d=a),a=Number(a),d=Number(d),e.ready&&!e.disabled&&e.options.movable&&(b(a)&&(f.left=a,g=!0),b(d)&&(f.top=d,g=!0),g&&e.renderCanvas(!0)),e},zoom:function(a,b){var c=this,d=c.canvasData;return a=Number(a),a=0>a?1/(1-a):1+a,c.zoomTo(d.width*a/d.naturalWidth,b)},zoomTo:function(a,b){var c=this,d=c.options,e=c.canvasData,f=e.width,g=e.height,h=e.naturalWidth,i=e.naturalHeight;if(a=Number(a),a>=0&&c.ready&&!c.disabled&&d.zoomable){var j=h*a,k=i*a;if(w(c.element,"zoom",{originalEvent:b,oldRatio:f/h,ratio:j/h})===!1)return c;if(b){var l=c.pointers,m=y(c.cropper),n=l&&Object.keys(l).length?R(l):{pageX:b.pageX,pageY:b.pageY};e.left-=(j-f)*((n.pageX-m.left-e.left)/f),e.top-=(k-g)*((n.pageY-m.top-e.top)/g)}else e.left-=(j-f)/2,e.top-=(k-g)/2;e.width=j,e.height=k,c.renderCanvas(!0)}return c},rotate:function(a){var b=this;return b.rotateTo((b.imageData.rotate||0)+Number(a))},rotateTo:function(a){var c=this;return a=Number(a),b(a)&&c.ready&&!c.disabled&&c.options.rotatable&&(c.imageData.rotate=a%360,c.rotated=!0,c.renderCanvas(!0)),c},scale:function(a,d){var e=this,f=e.imageData,g=!1;return c(d)&&(d=a),a=Number(a),d=Number(d),e.ready&&!e.disabled&&e.options.scalable&&(b(a)&&(f.scaleX=a,g=!0),b(d)&&(f.scaleY=d,g=!0),g&&e.renderImage(!0)),e},scaleX:function(a){var c=this,d=c.imageData.scaleY;return c.scale(a,b(d)?d:1)},scaleY:function(a){var c=this,d=c.imageData.scaleX;return c.scale(b(d)?d:1,a)},getData:function(a){var b=this,c=b.options,d=b.imageData,e=b.canvasData,f=b.cropBoxData,g=void 0,h=void 0;return b.ready&&b.cropped?(h={x:f.left-e.left,y:f.top-e.top,width:f.width,height:f.height},g=d.width/d.naturalWidth,i(h,function(b,c){b/=g,h[c]=a?Math.round(b):b})):h={x:0,y:0,width:0,height:0},c.rotatable&&(h.rotate=d.rotate||0),c.scalable&&(h.scaleX=d.scaleX||1,h.scaleY=d.scaleY||1),h},setData:function(a){var c=this,d=c.options,g=c.imageData,h=c.canvasData,i={},j=void 0,k=void 0,l=void 0;return f(a)&&(a=a.call(c.element)),c.ready&&!c.disabled&&e(a)&&(d.rotatable&&b(a.rotate)&&a.rotate!==g.rotate&&(g.rotate=a.rotate,c.rotated=j=!0),d.scalable&&(b(a.scaleX)&&a.scaleX!==g.scaleX&&(g.scaleX=a.scaleX,k=!0),b(a.scaleY)&&a.scaleY!==g.scaleY&&(g.scaleY=a.scaleY,k=!0)),j?c.renderCanvas():k&&c.renderImage(),l=g.width/g.naturalWidth,b(a.x)&&(i.left=a.x*l+h.left),b(a.y)&&(i.top=a.y*l+h.top),b(a.width)&&(i.width=a.width*l),b(a.height)&&(i.height=a.height*l),c.setCropBoxData(i)),c},getContainerData:function(){var a=this;return a.ready?a.containerData:{}},getImageData:function(){var a=this;return a.loaded?a.imageData:{}},getCanvasData:function(){var a=this,b=a.canvasData,c={};return a.ready&&i(["left","top","width","height","naturalWidth","naturalHeight"],function(a){c[a]=b[a]}),c},setCanvasData:function(a){var c=this,d=c.canvasData,g=d.aspectRatio;return f(a)&&(a=a.call(c.element)),c.ready&&!c.disabled&&e(a)&&(b(a.left)&&(d.left=a.left),b(a.top)&&(d.top=a.top),b(a.width)?(d.width=a.width,d.height=a.width/g):b(a.height)&&(d.height=a.height,d.width=a.height*g),c.renderCanvas(!0)),c},getCropBoxData:function(){var a=this,b=a.cropBoxData,c=void 0;return a.ready&&a.cropped&&(c={left:b.left,top:b.top,width:b.width,height:b.height}),c||{}},setCropBoxData:function(a){var c=this,d=c.cropBoxData,g=c.options.aspectRatio,h=void 0,i=void 0;return f(a)&&(a=a.call(c.element)),c.ready&&c.cropped&&!c.disabled&&e(a)&&(b(a.left)&&(d.left=a.left),b(a.top)&&(d.top=a.top),b(a.width)&&a.width!==d.width&&(h=!0,d.width=a.width),b(a.height)&&a.height!==d.height&&(i=!0,d.height=a.height),g&&(h?d.height=d.width/g:i&&(d.width=d.height*g)),c.renderCropBox()),c},getCroppedCanvas:function(a){var b=this;if(!b.ready||!window.HTMLCanvasElement)return null;if(!b.cropped)return K(b.image,b.imageData);e(a)||(a={});var c=b.getData(),d=c.width,f=c.height,g=d/f,h=void 0,i=void 0,j=void 0;e(a)&&(h=a.width,i=a.height,h?(i=h/g,j=h/d):i&&(h=i*g,j=i/f));var k=Math.floor(h||d),l=Math.floor(i||f),m=B("canvas"),n=m.getContext("2d");m.width=k,m.height=l,a.fillColor&&(n.fillStyle=a.fillColor,n.fillRect(0,0,k,l));var o=function(){var a=K(b.image,b.imageData),e=a.width,g=a.height,h=b.canvasData,i=[a],k=c.x+h.naturalWidth*(Math.abs(c.scaleX||1)-1)/2,l=c.y+h.naturalHeight*(Math.abs(c.scaleY||1)-1)/2,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0;return-d>=k||k>e?k=m=o=q=0:0>=k?(o=-k,k=0,m=q=Math.min(e,d+k)):e>=k&&(o=0,m=q=Math.min(d,e-k)),0>=m||-f>=l||l>g?l=n=p=r=0:0>=l?(p=-l,l=0,n=r=Math.min(g,f+l)):g>=l&&(p=0,n=r=Math.min(f,g-l)),i.push(Math.floor(k),Math.floor(l),Math.floor(m),Math.floor(n)),j&&(o*=j,p*=j,q*=j,r*=j),q>0&&r>0&&i.push(Math.floor(o),Math.floor(p),Math.floor(q),Math.floor(r)),i}();return n.drawImage.apply(n,X(o)),m},setAspectRatio:function(a){var b=this,d=b.options;return b.disabled||c(a)||(d.aspectRatio=Math.max(0,a)||NaN,b.ready&&(b.initCropBox(),b.cropped&&b.renderCropBox())),b},setDragMode:function(a){var b=this,c=b.options,d=b.dragBox,e=b.face,f=void 0,g=void 0;return b.loaded&&!b.disabled&&(f="crop"===a,g=c.movable&&"move"===a,a=f||g?a:"none",s(d,"action",a),p(d,"cropper-crop",f),p(d,"cropper-move",g),c.cropBoxMovable||(s(e,"action",a),p(e,"cropper-crop",f),p(e,"cropper-move",g))),b}},La="cropper",Ma=La+"-hidden",Na="error",Oa="load",Pa="ready",Qa="crop",Ra=/^data:/,Sa=/^data:image\/jpeg.*;base64,/,Ta=void 0,Ua=function(){function a(b,c){V(this,a);var d=this;d.element=b,d.options=j({},S,e(c)&&c),d.loaded=!1,d.ready=!1,d.complete=!1,d.rotated=!1,d.cropped=!1,d.disabled=!1,d.replaced=!1,d.limited=!1,d.wheeling=!1,d.isImg=!1,d.originalUrl="",d.canvasData=null,d.cropBoxData=null,d.previews=null,d.pointers={},d.init()}return W(a,[{key:"init",value:function(){var a=this,b=a.element,c=b.tagName.toLowerCase(),d=void 0;if(!r(b,La)){if(s(b,La,a),"img"===c){if(a.isImg=!0,a.originalUrl=d=b.getAttribute("src"),!d)return;d=b.src}else"canvas"===c&&window.HTMLCanvasElement&&(d=b.toDataURL());a.load(d)}}},{key:"load",value:function(a){var b=this,c=b.options,d=b.element;if(a){if(b.url=a,b.imageData={},!c.checkOrientation||!window.ArrayBuffer)return void b.clone();if(Ra.test(a))return void(Sa?b.read(N(a)):b.clone());var e=new XMLHttpRequest;e.onerror=e.onabort=function(){b.clone()},e.onload=function(){b.read(e.response)},c.checkCrossOrigin&&F(a)&&d.crossOrigin&&(a=G(a)),e.open("get",a),e.responseType="arraybuffer",e.send()}}},{key:"read",value:function(a){var b=this,c=b.options,d=M(a),e=b.imageData,f=0,g=1,h=1;if(d>1)switch(b.url=O(a),d){case 2:g=-1;break;case 3:f=-180;break;case 4:h=-1;break;case 5:f=90,h=-1;break;case 6:f=90;break;case 7:f=90,g=-1;break;case 8:f=-90}c.rotatable&&(e.rotate=f),c.scalable&&(e.scaleX=g,e.scaleY=h),b.clone()}},{key:"clone",value:function(){var a=this,b=a.element,c=a.url,d=void 0,e=void 0,f=void 0,g=void 0;a.options.checkCrossOrigin&&F(c)&&(d=b.crossOrigin,d?e=c:(d="anonymous",e=G(c))),a.crossOrigin=d,a.crossOriginUrl=e;var h=B("img");d&&(h.crossOrigin=d),h.src=e||c,a.image=h,a.onStart=f=k(a.start,a),a.onStop=g=k(a.stop,a),a.isImg?b.complete?a.start():v(b,Oa,f):(v(h,Oa,f),v(h,Na,g),n(h,"cropper-hide"),b.parentNode.insertBefore(h,b.nextSibling))}},{key:"start",value:function(a){var b=this,c=b.isImg?b.element:b.image;a&&(u(c,Oa,b.onStart),u(c,Na,b.onStop)),H(c,function(a,c){j(b.imageData,{naturalWidth:a,naturalHeight:c,aspectRatio:a/c}),b.loaded=!0,b.build()})}},{key:"stop",value:function(){var a=this,b=a.image;u(b,Oa,a.onStart),u(b,Na,a.onStop),D(b),a.image=null}},{key:"build",value:function(){var a=this,b=a.options,c=a.element,d=a.image,e=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0;if(a.loaded){a.ready&&a.unbuild();var l=B("div");l.innerHTML=T,a.container=e=c.parentNode,a.cropper=g=A(l,"cropper-container")[0],a.canvas=h=A(g,"cropper-canvas")[0],a.dragBox=i=A(g,"cropper-drag-box")[0],a.cropBox=j=A(g,"cropper-crop-box")[0],a.viewBox=A(g,"cropper-view-box")[0],a.face=k=A(j,"cropper-face")[0],C(h,d),n(c,Ma),e.insertBefore(g,c.nextSibling),a.isImg||o(d,"cropper-hide"),a.initPreview(),a.bind(),b.aspectRatio=Math.max(0,b.aspectRatio)||NaN,b.viewMode=Math.max(0,Math.min(3,Math.round(b.viewMode)))||0,a.cropped=b.autoCrop,b.autoCrop?b.modal&&n(i,"cropper-modal"):n(j,Ma),b.guides||n(A(j,"cropper-dashed"),Ma),b.center||n(A(j,"cropper-center"),Ma),b.background&&n(g,"cropper-bg"),b.highlight||n(k,"cropper-invisible"),b.cropBoxMovable&&(n(k,"cropper-move"),s(k,"action","all")),b.cropBoxResizable||(n(A(j,"cropper-line"),Ma),
n(A(j,"cropper-point"),Ma)),a.setDragMode(b.dragMode),a.render(),a.ready=!0,a.setData(b.data),a.completing=setTimeout(function(){f(b.ready)&&v(c,Pa,b.ready,!0),w(c,Pa),w(c,Qa,a.getData()),a.complete=!0},0)}}},{key:"unbuild",value:function(){var a=this;a.ready&&(a.complete||clearTimeout(a.completing),a.ready=!1,a.complete=!1,a.initialImageData=null,a.initialCanvasData=null,a.initialCropBoxData=null,a.containerData=null,a.canvasData=null,a.cropBoxData=null,a.unbind(),a.resetPreview(),a.previews=null,a.viewBox=null,a.cropBox=null,a.dragBox=null,a.canvas=null,a.container=null,D(a.cropper),a.cropper=null)}}],[{key:"noConflict",value:function(){return window.Cropper=Ta,a}},{key:"setDefaults",value:function(a){j(S,e(a)&&a)}}]),a}();return j(Ua.prototype,ja),j(Ua.prototype,la),j(Ua.prototype,ya),j(Ua.prototype,Aa),j(Ua.prototype,Ja),j(Ua.prototype,Ka),"undefined"!=typeof window&&(Ta=window.Cropper,window.Cropper=Ua),Ua});